<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="/pragmaticformalmodeling/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/pragmaticformalmodeling/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-VEQJ8PBLCD"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-VEQJ8PBLCD', { 'anonymize_ip': true }); </script> <script type="text/javascript" src="/pragmaticformalmodeling/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Coordinating a Database and Blob Store | Pragmatic Formal Modeling</title> <meta name="generator" content="Jekyll v3.9.2" /> <meta property="og:title" content="Coordinating a Database and Blob Store" /> <meta name="author" content="Elliot Swart" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Use formal modeling to reduce errors in a simple and common distributed system." /> <meta property="og:description" content="Use formal modeling to reduce errors in a simple and common distributed system." /> <link rel="canonical" href="https://elliotswart.github.io/pragmaticformalmodeling/database-blob/" /> <meta property="og:url" content="https://elliotswart.github.io/pragmaticformalmodeling/database-blob/" /> <meta property="og:site_name" content="Pragmatic Formal Modeling" /> <meta property="og:image" content="https://elliotswart.github.io/pragmaticformalmodeling/logo.png" /> <meta property="og:image:height" content="150" /> <meta property="og:image:width" content="150" /> <meta property="og:image:alt" content="Temporal Logic Symbol for Eventually" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary_large_image" /> <meta property="twitter:image" content="https://elliotswart.github.io/pragmaticformalmodeling/logo.png" /> <meta name="twitter:image:alt" content="Temporal Logic Symbol for Eventually" /> <meta property="twitter:title" content="Coordinating a Database and Blob Store" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Elliot Swart","url":"https://www.linkedin.com/in/elliotswart/"},"description":"Use formal modeling to reduce errors in a simple and common distributed system.","headline":"Coordinating a Database and Blob Store","image":{"alt":"Temporal Logic Symbol for Eventually","height":150,"width":150,"url":"https://elliotswart.github.io/pragmaticformalmodeling/logo.png","@type":"imageObject"},"url":"https://elliotswart.github.io/pragmaticformalmodeling/database-blob/"}</script> <!-- End Jekyll SEO tag --> <link rel="icon" href="/favicon.ico" sizes="any"> <link rel="icon" href="/favicon.svg" type="image/svg+xml"> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://elliotswart.github.io/pragmaticformalmodeling/" class="site-title lh-tight"> Pragmatic Formal Modeling </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://elliotswart.github.io/pragmaticformalmodeling/" class="nav-list-link">Introduction to Pragmatic Formal Modeling</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://elliotswart.github.io/pragmaticformalmodeling/database-blob/" class="nav-list-link active">Coordinating a Database and Blob Store</a><ul class="nav-list "><li class="nav-list-item "><a href="https://elliotswart.github.io/pragmaticformalmodeling/database-blob/naive/" class="nav-list-link">(Start of Process) The naive first draft</a></li><li class="nav-list-item "><a href="https://elliotswart.github.io/pragmaticformalmodeling/database-blob/improved/" class="nav-list-link">(Progressive Refinement) An improved solution</a></li><li class="nav-list-item "><a href="https://elliotswart.github.io/pragmaticformalmodeling/database-blob/working/" class="nav-list-link">(Verifying Correctness) A working solution</a></li><li class="nav-list-item "><a href="https://elliotswart.github.io/pragmaticformalmodeling/database-blob/cost-efficent/" class="nav-list-link">(Adding Requirements) A more cost efficent solution</a></li><li class="nav-list-item "><a href="https://elliotswart.github.io/pragmaticformalmodeling/database-blob/storage-cleaner-naive/" class="nav-list-link">(Implementing New Requirements) A naive update</a></li><li class="nav-list-item "><a href="https://elliotswart.github.io/pragmaticformalmodeling/database-blob/storage-cleaner-improved/" class="nav-list-link">(Implementing New Requirements) Significant improvement</a></li><li class="nav-list-item "><a href="https://elliotswart.github.io/pragmaticformalmodeling/database-blob/storage-cleaner-working/" class="nav-list-link">(Implementing New Requirements) A working update</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://elliotswart.github.io/pragmaticformalmodeling/caching/" class="nav-list-link">Cache Invalidation</a><ul class="nav-list "><li class="nav-list-item "><a href="https://elliotswart.github.io/pragmaticformalmodeling/caching/naive-model/" class="nav-list-link">A naive model of caching</a></li><li class="nav-list-item "><a href="https://elliotswart.github.io/pragmaticformalmodeling/caching/cache-invalidation/" class="nav-list-link">Adding cache invalidation</a></li><li class="nav-list-item "><a href="https://elliotswart.github.io/pragmaticformalmodeling/caching/working-cache-invalidation/" class="nav-list-link">Working cache invalidation</a></li><li class="nav-list-item "><a href="https://elliotswart.github.io/pragmaticformalmodeling/caching/reproducing-the-bug/" class="nav-list-link">Reproducing Facebook's bug</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://elliotswart.github.io/pragmaticformalmodeling/business-logic/" class="nav-list-link">Business Logic</a><ul class="nav-list "><li class="nav-list-item "><a href="https://elliotswart.github.io/pragmaticformalmodeling/business-logic/enterprise-architect/" class="nav-list-link">Enterprise Architect gets us started</a></li><li class="nav-list-item "><a href="https://elliotswart.github.io/pragmaticformalmodeling/business-logic/junior-dev/" class="nav-list-link">Junior Developer tries their best</a></li><li class="nav-list-item "><a href="https://elliotswart.github.io/pragmaticformalmodeling/business-logic/principal-eng/" class="nav-list-link">Principal Engineer saves the day</a></li></ul></li><li class="nav-list-item"><a href="https://elliotswart.github.io/pragmaticformalmodeling/learning-material/" class="nav-list-link">Learning Material</a></li><li class="nav-list-item"><a href="https://elliotswart.github.io/pragmaticformalmodeling/tools/" class="nav-list-link">Tools and Additional Citations</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/ElliotSwart/pragmaticformalmodeling" class="site-button" target="_blank" rel="noopener noreferrer" > GitHub Repository </a> </li> <li class="aux-nav-list-item"> <a href="https://www.linkedin.com/in/elliotswart/" class="site-button" target="_blank" rel="noopener noreferrer" > About the Author </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="coordinating-a-database-and-blob-store"> <a href="#coordinating-a-database-and-blob-store" class="anchor-heading" aria-labelledby="coordinating-a-database-and-blob-store"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Coordinating a Database and Blob Store </h1> <ol id="markdown-toc"> <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li> <li><a href="#modeling-the-problem" id="markdown-toc-modeling-the-problem">Modeling the problem</a></li> </ol> <h2 id="introduction"> <a href="#introduction" class="anchor-heading" aria-labelledby="introduction"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Introduction </h2> <p>Let’s start with something that millions of engineers do each year: coordinating databases and blob stores (like Amazon S3, Azure Blob, GCP Cloud Storage). Why might we need to do this?</p> <p>You have a site with users. You want each user to have a profile image. How do you do this? The easiest way is to store the user metadata and the image in your database. You can do this transactionally: either the metadata and the image are both stored, or neither is stored. This way you don’t have to worry about inconsistent cases where the image is stored, but the user isn’t, or the user is stored, but the image isn’t.</p> <p>In practice, this approach doesn’t scale easily or cheaply. Transactional databases are typically the performance bottleneck in a system, and you don’t want to take up their storage, read, and write capacity unnecessarily. What if users need to add more media beyond just a profile picture? This can quickly become an expensive prospect. Blob stores, on the other hand, are relatively cheap and highly scaleable and can easily hold as many files as you’d practically need. They also don’t consume database CPU cycles. Just one problem: they aren’t tied in with the database’s transaction coordinator. You as the programmer need to figure out an application level solution to link the database and blob stores, so when a request comes in for a user and their profile picture, you can return it. This is a simple and common distributed system, which makes it a perfect place to start.</p> <h2 id="modeling-the-problem"> <a href="#modeling-the-problem" class="anchor-heading" aria-labelledby="modeling-the-problem"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Modeling the problem </h2> <p>We have three components in this system that we must consider: the <strong>Database</strong>, the <strong>Blob Store</strong> and the <strong>Servers</strong>. Note we consider the <strong>Database</strong> and the <strong>Blob Store</strong> each as individual entities. If we were to look at their implementation, we would potentially see shards and replication over a number of instances. However, the designers of those products expose interfaces with particular properties that can hide this complexity.</p> <ul> <li><strong>Database</strong>: Allow <a href="https://databricks.com/glossary/acid-transactions">ACID Transactions</a>. The important part for us is that the full database update either will succeed or fail; we don’t need to account for a partial completion of the update.</li> <li><strong>Blob Store</strong>: All the main blob stores have <a href="https://levelup.gitconnected.com/aws-azure-gcp-object-storage-services-5f1b2945cc11">Read After Write</a> consistency. This means that as soon as a write returns successfully, all subsequent reads will return the new value. This shouldn’t be taken for granted in eventually consistent systems; it may take time after a write is completed to be sure that value will be returned in all cases. Additionally, all the blob stores are atomic on writes, meaning we don’t have to account for files being partially uploaded and left in an invalid state that clients could read.</li> </ul> <p>The <strong>Servers</strong>, however, are our responsibility. They use the read and write interfaces exposed by the data stores however our application is written to use them. Note the plural in Servers: we have to deal with the fact that multiple instances of our application are running simultaneously. We are assuming a single thread per Server, processing a single request at a time. Although in practice many threads could be on a single <strong>Server</strong>, it is logically equivalent to the case where there are multiple <strong>Servers</strong> each with one thread.</p> <p>We can model this with the <a href="https://www.smartdraw.com/component-diagram/">UML Component Diagram</a> below:</p> <div class="plantuml theme-plain"><svg contentScriptType='application/ecmascript' contentStyleType='text/css' height='343px' preserveAspectRatio='none' style='width:800px;height:343px;background:#FFFFFF;' version='1.1' viewBox='0 0 800 343' width='800px' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns='http://www.w3.org/2000/svg' zoomAndPan='magnify'><defs/><g><!--MD5=[5b72e4bf204b8ec5342812f0e5cde2b6] entity BlobStore--><rect fill='#FFFFFF' height='47.0146' style='stroke:#000000;stroke-width:1.0;' width='114' x='680' y='232.5'/><rect fill='#FFFFFF' height='10' style='stroke:#000000;stroke-width:1.0;' width='15' x='774' y='237.5'/><rect fill='#FFFFFF' height='2' style='stroke:#000000;stroke-width:1.0;' width='4' x='772' y='239.5'/><rect fill='#FFFFFF' height='2' style='stroke:#000000;stroke-width:1.0;' width='4' x='772' y='243.5'/><text fill='#000000' font-family='Verdana' font-size='14' lengthAdjust='spacing' textLength='74' x='695' y='266.5752'>Blob Store</text><!--MD5=[7405d0e69469de312847cbda47a2bf4e] entity BlobRead--><ellipse cx='557' cy='304' fill='#FFFFFF' rx='8' ry='8' style='stroke:#000000;stroke-width:1.0;'/><text fill='#000000' font-family='Verdana' font-size='14' lengthAdjust='spacing' textLength='71' x='521.5' y='335.0752'>Blob Read</text><!--MD5=[d141281bb52b0da0d699f4ffadfc55dd] entity BlobWrite--><ellipse cx='557' cy='209' fill='#FFFFFF' rx='8' ry='8' style='stroke:#000000;stroke-width:1.0;'/><text fill='#000000' font-family='Verdana' font-size='14' lengthAdjust='spacing' textLength='74' x='520' y='240.0752'>Blob Write</text><!--MD5=[fa1e3283224feb76407c84b7e90ed808] entity Database--><rect fill='#FFFFFF' height='47.0146' style='stroke:#000000;stroke-width:1.0;' width='105' x='684.5' y='43.5'/><rect fill='#FFFFFF' height='10' style='stroke:#000000;stroke-width:1.0;' width='15' x='769.5' y='48.5'/><rect fill='#FFFFFF' height='2' style='stroke:#000000;stroke-width:1.0;' width='4' x='767.5' y='50.5'/><rect fill='#FFFFFF' height='2' style='stroke:#000000;stroke-width:1.0;' width='4' x='767.5' y='54.5'/><text fill='#000000' font-family='Verdana' font-size='14' lengthAdjust='spacing' textLength='65' x='699.5' y='77.5752'>Database</text><!--MD5=[5463efe71bb7d0bc6fddd431c7487003] entity DatabaseRead--><ellipse cx='557' cy='114' fill='#FFFFFF' rx='8' ry='8' style='stroke:#000000;stroke-width:1.0;'/><text fill='#000000' font-family='Verdana' font-size='14' lengthAdjust='spacing' textLength='105' x='504.5' y='145.0752'>Metadata Read</text><!--MD5=[6872c60db3038af11b5d3c926c6bd1a5] entity DatabaseWrite--><ellipse cx='557' cy='19' fill='#FFFFFF' rx='8' ry='8' style='stroke:#000000;stroke-width:1.0;'/><text fill='#000000' font-family='Verdana' font-size='14' lengthAdjust='spacing' textLength='108' x='503' y='50.0752'>Metadata Write</text><!--MD5=[fd05da50d3a5e6443950971743d25075] entity Servers--><rect fill='#FFFFFF' height='47.0146' style='stroke:#000000;stroke-width:1.0;' width='93' x='310' y='138.5'/><rect fill='#FFFFFF' height='10' style='stroke:#000000;stroke-width:1.0;' width='15' x='383' y='143.5'/><rect fill='#FFFFFF' height='2' style='stroke:#000000;stroke-width:1.0;' width='4' x='381' y='145.5'/><rect fill='#FFFFFF' height='2' style='stroke:#000000;stroke-width:1.0;' width='4' x='381' y='149.5'/><text fill='#000000' font-family='Verdana' font-size='14' lengthAdjust='spacing' textLength='53' x='325' y='172.5752'>Servers</text><!--MD5=[0b444684cd4b3bd87893d933a0d4c854] entity WriteProfile--><ellipse cx='126' cy='114' fill='#FFFFFF' rx='8' ry='8' style='stroke:#000000;stroke-width:1.0;'/><text fill='#000000' font-family='Verdana' font-size='14' lengthAdjust='spacing' textLength='230' x='11' y='145.0752'>Create or Update Profile (userId)</text><!--MD5=[687d0c272cff8dd01da5433de18a6198] entity ReadProfile--><ellipse cx='126' cy='209' fill='#FFFFFF' rx='8' ry='8' style='stroke:#000000;stroke-width:1.0;'/><text fill='#000000' font-family='Verdana' font-size='14' lengthAdjust='spacing' textLength='145' x='53.5' y='240.0752'>Read Profile (userId)</text><!--MD5=[1c855f0a3fec6631d282fd37f1212b4d] link BlobRead to BlobStore--><path d='M566.11,301.81 C585.97,296.46 638.44,282.31 679.86,271.14 ' fill='none' id='BlobRead-BlobStore' style='stroke:#000000;stroke-width:1.0;'/><!--MD5=[f4bb1736738eb9eb432a1a7f518ea3bd] link BlobWrite to BlobStore--><path d='M566.11,211.14 C585.97,216.39 638.44,230.24 679.86,241.18 ' fill='none' id='BlobWrite-BlobStore' style='stroke:#000000;stroke-width:1.0;'/><!--MD5=[2d78ddc40ddac6e923f7c3d67a75dd31] link DatabaseRead to Database--><path d='M566.11,111.86 C586.72,106.42 642.43,91.71 684.49,80.6 ' fill='none' id='DatabaseRead-Database' style='stroke:#000000;stroke-width:1.0;'/><!--MD5=[cf52d2d64027b8aced9bb2451c9ce20a] link DatabaseWrite to Database--><path d='M566.11,21.19 C586.72,26.74 642.43,41.77 684.49,53.11 ' fill='none' id='DatabaseWrite-Database' style='stroke:#000000;stroke-width:1.0;'/><!--MD5=[e64d92c4c2a8bc8c576451efccd26604] link Servers to DatabaseRead--><path d='M403.04,150.99 C448.32,140.04 514.95,123.93 542.9,117.17 ' fill='none' id='Servers-to-DatabaseRead' style='stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;'/><polygon fill='#000000' points='547.96,115.94,538.273,114.1616,543.0994,117.1123,540.1487,121.9386,547.96,115.94' style='stroke:#000000;stroke-width:1.0;'/><text fill='#000000' font-family='Verdana' font-size='13' lengthAdjust='spacing' textLength='30' x='434' y='134.0698'>uses</text><!--MD5=[07c9efc67fe536d27b19938a7473308e] link Servers to DatabaseWrite--><path d='M390.28,138.39 C435.2,106.03 513.74,49.44 543.81,27.78 ' fill='none' id='Servers-to-DatabaseWrite' style='stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;'/><polygon fill='#000000' points='547.89,24.84,538.2467,26.8419,543.8291,27.757,542.9139,33.3393,547.89,24.84' style='stroke:#000000;stroke-width:1.0;'/><text fill='#000000' font-family='Verdana' font-size='13' lengthAdjust='spacing' textLength='30' x='434' y='84.0698'>uses</text><!--MD5=[8db1415e81cc2ac421bd9acd0fbbfa50] link Servers to BlobRead--><path d='M390.72,185.77 C435.56,217.84 513.31,273.46 543.5,295.06 ' fill='none' id='Servers-to-BlobRead' style='stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;'/><polygon fill='#000000' points='547.93,298.23,542.9398,289.739,543.8642,295.3198,538.2834,296.2442,547.93,298.23' style='stroke:#000000;stroke-width:1.0;'/><text fill='#000000' font-family='Verdana' font-size='13' lengthAdjust='spacing' textLength='30' x='434' y='213.0698'>uses</text><!--MD5=[33835360ad07c980cbfba422f2364971] link Servers to BlobWrite--><path d='M403.25,175.99 C413.03,178.8 423.32,181.61 433,184 C472.59,193.77 520.03,202.62 542.68,206.67 ' fill='none' id='Servers-to-BlobWrite' style='stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;'/><polygon fill='#000000' points='547.89,207.59,539.7267,202.08,542.9668,206.717,538.3298,209.9571,547.89,207.59' style='stroke:#000000;stroke-width:1.0;'/><text fill='#000000' font-family='Verdana' font-size='13' lengthAdjust='spacing' textLength='30' x='434' y='181.0698'>uses</text><!--MD5=[2a31410feb1279b175af75437364b859] link ReadProfile to Servers--><path d='M135.13,207.33 C162.64,201.67 253.61,182.96 309.7,171.42 ' fill='none' id='ReadProfile-Servers' style='stroke:#000000;stroke-width:1.0;'/><!--MD5=[27d96b2089a1fa08298a9a5698103670] link WriteProfile to Servers--><path d='M135.13,115.71 C162.64,121.49 253.61,140.6 309.7,152.38 ' fill='none' id='WriteProfile-Servers' style='stroke:#000000;stroke-width:1.0;'/></g></svg></div> <p>We are implementing two interfaces with our server: <em>Write Profile</em> and <em>Read Profile</em>.</p> <ul> <li><em>Create or Update Profile (userId)</em>: leads to one of the following post conditions: <ul> <li>The database contains metadata about the profile. The blob store contains the profile image. There is some way to link the two.</li> <li>The API call fails in such a way that both datastores are left in a consistent state that does not disrupt <em>Read Profile</em> or prevent a successful retry.</li> </ul> </li> <li><em>Read Profile (userId)</em>: For a given profile, both the metadata and the profile image are returned. It is unacceptable to return one without the other. Returning None is acceptable when a good result is impossible, but unacceptable otherwise.</li> </ul> <p>Note that we are not modelling the clients of these APIs. However, the consistency guarantees set out above would allow someone else to do so.</p> <p><br /><br /></p> <div class="table-wrapper"><table> <tbody> <tr> <td>Next: <a href="naive">(Start of Process) The naive first draft</a></td> </tr> </tbody> </table></div> <hr> <footer> <p><a href="#top" id="back-to-top">Back to top</a></p> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2022 Elliot Swart. Distributed by an <a href="https://github.com/ElliotSwart/pragmaticformalmodeling/blob/main/LICENSE.md">MIT license.</a> </p> <div class="d-flex mt-2"> <p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/ElliotSwart/pragmaticformalmodeling/tree/main/database-blob/index.md" id="edit-this-page">Edit this page on GitHub</a> </p> </div> </footer> </div> </div> </div> </body> </html>
